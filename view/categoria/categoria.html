<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minhas Categorias</title>

    <link rel="stylesheet" href="../gastos/style.css">
    <link rel="stylesheet" href="../categoria/categoria.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="container-app">
        <nav class="barra-lateral">
            <div class="area-logo"><img src="../assets/image.png" alt="Logo" class="icone-nav logo-img"></div>
            <ul class="nav-lateral">
                <li class="item-nav">
                    <a href="../gastos/gastos.html" class="link-nav" title="Home">
                        <img src="../assets/gastos.png" class="icone-nav" alt="Home">
                    </a>
                </li>

                <li class="item-nav">
                    <a href="../planejamento/caixas.html" class="link-nav" title="Caixas">
                        <img src="../assets/planejamento.png" class="icone-nav" alt="Caixas">
                    </a>
                </li>

                <li class="item-nav ativo">
                    <a href="../categoria/categoria.html" class="link-nav" title="Categorias">
                        <img src="../assets/categoria.webp" class="icone-nav" alt="Categorias">
                    </a>
                </li>

                <li class="item-nav" style="margin-top: auto;">
                    <a href="../perfil/perfil.html" class="link-nav" id="btn-abrir-usuario" title="Minha Conta">
                        <img src="../assets/user.svg" class="icone-nav" alt="Perfil">
                    </a>
                </li>
            </ul>
        </nav>

        <div class="wrapper-principal">

            <header class="cabecalho-pagina">
                <div class="navegador-mes">
                    <button class="seta-nav">&lt;</button>
                    <span class="mes-atual">Janeiro 2025</span>
                    <button class="seta-nav">&gt;</button>
                </div>
            </header>

            <main class="area-conteudo-dividida">

                <section class="painel-categorias">
                    <div class="cabecalho-painel">
                        <h2 class="titulo-painel">Gerenciar Categorias</h2>
                        <button class="btn-nova-categoria" onclick="abrirModalCriacao()">
                            + Nova Categoria
                        </button>
                    </div>

                    <div class="container-tabela">
                        <table class="tabela-categorias">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>% Ocupada</th>
                                    <th>% Livre</th>
                                    <th>Total (R$)</th>
                                    <th class="col-acoes">Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </section>

                <aside class="painel-resumo-lateral">
                    <div class="card-resumo">
                        <h3 class="titulo-resumo">Resumo Mensal</h3>
                        <table class="tabela-resumo">
                            <thead>
                                <tr>
                                    <th>Cat.</th>
                                    <th>Gasto</th>
                                    <th>Limite</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="3" style="text-align:center; color:#ccc;">Carregando dados...</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="container-grafico">
                            <canvas id="categoriasPieChart"></canvas>
                        </div>
                    </div>
                </aside>

            </main>
        </div>
    </div>

    <div class="modal-fundo" id="modal-nova-categoria" style="display: none;">
        <div class="modal-conteudo">
            <div class="cabecalho-modal">
                <h2 class="titulo-modal" id="modal-categoria-titulo">Nova Categoria</h2>
                <button class="fechar-modal" type="button"
                    onclick="document.getElementById('modal-nova-categoria').style.display='none'">×</button>
            </div>

            <form class="formulario-transacao" id="form-nova-categoria">
                <div class="grupo-form">
                    <label for="categoria-nome" class="rotulo-form">Nome da Categoria</label>
                    <input type="text" id="categoria-nome" class="input-form" placeholder="Ex: Supermercado" required>
                </div>

                <div class="grupo-form-linha">
                    <div class="grupo-form">
                        <label for="categoria-limite" class="rotulo-form">Limite Mensal (R$)</label>
                        <input type="number" id="categoria-limite" class="input-form" step="0.01" placeholder="1000.00"
                            required>
                    </div>
                    <div class="grupo-form">
                        <label for="categoria-cor" class="rotulo-form">Cor</label>
                        <input type="color" id="categoria-cor" class="input-form" style="height: 48px; padding: 5px;"
                            value="#41B06E">
                    </div>
                </div>

                <div class="acoes-form">
                    <button type="button" class="botao-form-cancelar"
                        onclick="document.getElementById('modal-nova-categoria').style.display='none'">Cancelar</button>
                    <button type="submit" class="botao-form-enviar">Salvar Categoria</button>
                </div>
            </form>
        </div>
    </div>

    <div id="container-notificacoes"></div>

    <div class="modal-fundo" id="modal-aviso-exclusao" style="display: none;">
        <div class="modal-aviso-conteudo">
            <h3 class="titulo-aviso">Atenção!</h3>
            <p class="texto-aviso">
                Você está prestes a excluir a categoria <strong id="nome-categoria-excluir">...</strong>.
                <br><br>
                Isso criará um <span class="destaque-aviso">EFEITO CASCATA</span>:
                Todos os gastos vinculados a esta categoria também serão apagados permanentemente!
            </p>
            <div class="acoes-aviso">
                <button class="btn-cancelar-aviso" onclick="fecharModalAviso()">Cancelar</button>
                <button class="btn-confirmar-aviso" id="btn-confirmar-exclusao">Sim, excluir tudo</button>
            </div>
        </div>
    </div>

    <script src="script-categoria.js"></script>
</body>

</html>